// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 0",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 1",
  "request": {
    "userIdentity": {
      "scopes": [],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `Array []`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 2",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.*",
        "system/Patient.write",
        "system/Observation.read",
        "system/Condition.read",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 3",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "patient/Condition.*",
        "user/Patient.read",
        "user/Observation.write",
        "user/Condition.read",
        "user/*.read",
        "system/Patient.*",
        "system/Observation.*",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 4",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "user/Patient.read",
        "user/Patient.*",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.*",
        "system/Observation.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Patient",
  "Observation",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 5",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Condition.*",
        "patient/*.read",
        "user/Observation.write",
        "user/Observation.*",
        "user/*.read",
        "system/Patient.write",
        "system/Observation.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 6",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Observation.*",
        "user/Condition.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Patient",
  "Condition",
  "Observation",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 7",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Condition.*",
        "user/*.read",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 8",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/*.read",
        "user/Patient.read",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Observation.read",
        "system/Observation.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 9",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Patient.*",
        "user/Observation.write",
        "system/Patient.write",
        "system/Patient.*",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Observation",
  "Condition",
  "Patient",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 10",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "patient/*.read",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.*",
        "system/Patient.*",
        "system/Observation.*",
        "system/Condition.read",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 11",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Condition.write",
        "user/Patient.read",
        "user/Patient.*",
        "user/Condition.read",
        "user/*.read",
        "system/Patient.write",
        "system/Observation.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 12",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/*.read",
        "system/Patient.write",
        "system/Observation.*",
        "system/Condition.*",
        "system/*.read"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Practitioner",
        "id": "id"
      },
      "usableScopes": [
        "user/*.read"
      ]
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 13",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Condition.write",
        "patient/*.read",
        "user/Observation.write",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.*",
        "system/Observation.read",
        "system/Condition.read"
      ],
      "patientLaunchContext": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "patient/*.read"
      ]
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 14",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Practitioner",
        "id": "id"
      },
      "usableScopes": [
        "user/*.read"
      ]
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 15",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Observation.*",
        "user/Condition.read",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 16",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "user/*.read"
      ]
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 17",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/*.read"
      ],
      "patientLaunchContext": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "patient/*.read"
      ]
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 18",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Condition.*",
        "user/Patient.read",
        "user/Observation.write",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.write",
        "system/Observation.*",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Patient",
  "Observation",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 19",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/*.read",
        "system/Patient.*",
        "system/Observation.read",
        "system/Condition.read",
        "system/*.read"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "user/*.read"
      ]
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 20",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Condition.write",
        "user/Observation.write",
        "user/Observation.*",
        "user/*.read",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "search-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 21",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.write",
        "system/Condition.read"
      ],
      "patientLaunchContext": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "patient/*.read"
      ]
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 22",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Condition.read",
        "user/*.read",
        "system/Observation.read",
        "system/Observation.*"
      ],
      "usableScopes": []
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "operation": "search-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 23",
  "request": {
    "userIdentity": {
      "scopes": [
        "user/Patient.read",
        "user/Observation.*",
        "user/Condition.*",
        "system/Patient.write",
        "system/Patient.*",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Patient",
  "Observation",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 24",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.*",
        "system/Patient.write",
        "system/Observation.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Patient",
  "Observation",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 25",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Condition.read",
        "user/*.read",
        "system/Patient.*",
        "system/Observation.read",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 26",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Observation.write",
        "user/Condition.read",
        "user/*.read",
        "system/Patient.write",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 27",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Observation.*",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.*",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Observation",
  "Patient",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 28",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.*",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 29",
  "request": {
    "userIdentity": {
      "scopes": [
        "user/Patient.read",
        "user/Observation.write",
        "user/Condition.read",
        "system/Observation.read",
        "system/Condition.read",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Patient",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 30",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.read",
        "system/Patient.*",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 31",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "patient/Condition.*",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Observation.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 32",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Condition.*",
        "user/Patient.*",
        "user/Condition.*",
        "system/Observation.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Patient",
  "Observation",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 33",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.read",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "history-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 34",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/*.read",
        "user/Patient.*",
        "user/Condition.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 35",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Patient.read",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.*",
        "user/*.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "operation": "history-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 36",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "user/Patient.read",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Patient",
  "Observation",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 37",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.*",
        "user/Condition.*",
        "user/*.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Practitioner",
        "id": "id"
      },
      "patientLaunchContext": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "patient/*.read",
        "user/*.read"
      ]
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 38",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "user/Condition.read",
        "user/*.read",
        "system/Patient.write",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/*.read"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Practitioner",
        "id": "id"
      },
      "usableScopes": [
        "user/*.read"
      ]
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 39",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.*",
        "system/Patient.*",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 40",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/*.read"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "patientLaunchContext": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "patient/*.read",
        "user/*.read"
      ]
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 41",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Observation",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 42",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Patient.read",
        "user/Observation.write",
        "user/Observation.*",
        "user/*.read",
        "system/Observation.read",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "user/*.read"
      ]
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 43",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/*.read",
        "user/Patient.*",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 44",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.*",
        "user/Patient.*",
        "user/Observation.write",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.*"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 45",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Observation.*",
        "system/Patient.write",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "patientLaunchContext": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "patient/*.read"
      ]
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 46",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Condition.*",
        "user/Condition.read",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Patient",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 47",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 48",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Condition.*",
        "patient/*.read",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 49",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/*.read",
        "system/Patient.write",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 50",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 51",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 52",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.read",
        "system/Patient.write",
        "system/Observation.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 53",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Observation.write",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.*",
        "system/Observation.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 54",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Condition.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Condition.read",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 55",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.write",
        "patient/*.read",
        "user/Observation.*",
        "user/Condition.*",
        "user/*.read",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 56",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/*.read",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 57",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.*",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Condition",
  "Patient",
  "Observation",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 58",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 59",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "system/Patient.*",
        "system/Observation.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Observation",
  "Condition",
  "Patient",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 60",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Patient",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 61",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/*.read",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 62",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.*",
        "system/Patient.*",
        "system/Condition.read",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Patient",
  "Observation",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 63",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/*.read",
        "user/Condition.read",
        "user/*.read",
        "system/Patient.write",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.*"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Practitioner",
        "id": "id"
      },
      "patientLaunchContext": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "patient/*.read",
        "user/*.read"
      ]
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 64",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 65",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "patient/Condition.*",
        "system/Patient.write",
        "system/Patient.*",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Observation",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 66",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.read",
        "user/Condition.*",
        "system/Patient.*",
        "system/Observation.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 67",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/*.read",
        "system/Patient.write",
        "system/Observation.*",
        "system/Condition.read",
        "system/*.read"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Practitioner",
        "id": "id"
      },
      "usableScopes": [
        "user/*.read"
      ]
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 68",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 69",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.*",
        "user/Patient.read",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 70",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.*",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Patient",
  "Observation",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 71",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Condition.read",
        "user/*.read",
        "system/Condition.read",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 72",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Condition.*",
        "patient/*.read",
        "user/Observation.*",
        "system/Observation.*",
        "system/Condition.read"
      ],
      "patientLaunchContext": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "patient/*.read"
      ]
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 73",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "user/*.read"
      ]
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 74",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.read",
        "system/Patient.write",
        "system/Observation.*",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 75",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Condition.write",
        "user/Observation.write",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.*",
        "system/Observation.read",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 76",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.read",
        "system/Patient.*",
        "system/Observation.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "patientLaunchContext": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "patient/*.read"
      ]
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 77",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.write",
        "user/Observation.write",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Observation.*",
        "system/Condition.read"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "user/*.read"
      ]
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 78",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Condition.write",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.*",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.*"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Patient",
  "Observation",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 79",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "patient/*.read",
        "user/Observation.write",
        "user/Condition.read",
        "user/*.read",
        "system/Observation.read",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 80",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "system/Patient.*",
        "system/Observation.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 81",
  "request": {
    "userIdentity": {
      "scopes": [
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 82",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Patient.read",
        "user/*.read",
        "system/Patient.*",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "operation": "search-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 83",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/*.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.write",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 84",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.read",
        "user/*.read",
        "system/Patient.*",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 85",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Observation.write",
        "user/Condition.*",
        "system/Patient.write",
        "system/Observation.read",
        "system/Observation.*"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "operation": "history-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 86",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "user/Patient.read",
        "user/Patient.*",
        "system/Patient.write",
        "system/Observation.*"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Patient",
  "Observation",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 87",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.*",
        "patient/*.read",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.*",
        "system/Observation.read",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "patientLaunchContext": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "patient/*.read"
      ]
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 88",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Condition.write",
        "user/Patient.read",
        "user/Observation.write",
        "user/Condition.read",
        "user/*.read",
        "system/Observation.read",
        "system/Observation.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 89",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.*",
        "system/Patient.write",
        "system/Patient.*",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 90",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "user/Patient.read",
        "user/Observation.*",
        "user/*.read",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 91",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 92",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "patient/*.read",
        "user/Observation.write",
        "user/Observation.*",
        "user/*.read",
        "system/Patient.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 93",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.write",
        "user/Patient.read",
        "user/Patient.*",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.write",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Patient",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 94",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Condition.read"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "user/*.read"
      ]
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 95",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 96",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/*.read",
        "user/Patient.read",
        "user/Observation.write",
        "user/Condition.read",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Condition.read",
        "system/*.read"
      ],
      "patientLaunchContext": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "patient/*.read"
      ]
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "search-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 97",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Observation",
  "Condition",
  "Patient",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 98",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "user/Patient.read",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.*",
        "user/*.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 99",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.*",
        "user/Condition.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 100",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Condition.*",
        "patient/*.read",
        "user/Observation.write",
        "user/*.read"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Practitioner",
        "id": "id"
      },
      "patientLaunchContext": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "patient/*.read",
        "user/*.read"
      ]
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 101",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "patient/Condition.write",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Observation",
  "Patient",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 102",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/*.read",
        "user/Observation.write",
        "user/Condition.*",
        "user/*.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Practitioner",
        "id": "id"
      },
      "usableScopes": [
        "user/*.read"
      ]
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 103",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Condition",
  "Patient",
  "Observation",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 104",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "user/Patient.read",
        "user/Observation.*",
        "user/Condition.read",
        "user/*.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 105",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Condition.*",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 106",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Condition.*",
        "user/*.read",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 107",
  "request": {
    "userIdentity": {
      "scopes": [
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Patient",
  "Observation",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 108",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "user/Patient.read",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 109",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.*",
        "user/Observation.write",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 110",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "user/Patient.read",
        "user/Observation.write",
        "user/Condition.read",
        "user/Condition.*",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Observation",
  "Patient",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 111",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "user/*.read"
      ]
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 112",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/*.read",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 113",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.*",
        "user/Patient.read",
        "user/Patient.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 114",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "user/Observation.write",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.write",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Patient",
  "Observation",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 115",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/*.read",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 116",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 117",
  "request": {
    "userIdentity": {
      "scopes": [
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "operation": "history-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Patient",
  "Observation",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 118",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Observation.write",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Observation.read",
        "system/Condition.read"
      ],
      "patientLaunchContext": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "patient/*.read"
      ]
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 119",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.write",
        "user/Patient.*",
        "user/Observation.*",
        "system/Patient.*",
        "system/Observation.*",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Patient",
  "Observation",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 120",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/*.read",
        "user/Observation.write",
        "user/Condition.read",
        "system/Observation.*",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 121",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.*",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Condition.read",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 122",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 123",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Observation.write",
        "system/Observation.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 124",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Condition.read",
        "user/*.read",
        "system/Patient.write",
        "system/Condition.*",
        "system/*.read"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Practitioner",
        "id": "id"
      },
      "patientLaunchContext": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "patient/*.read",
        "user/*.read"
      ]
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 125",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "user/Patient.read",
        "user/Observation.*",
        "user/Condition.*",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Observation",
  "Patient",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 126",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/*.read"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Practitioner",
        "id": "id"
      },
      "patientLaunchContext": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "patient/*.read",
        "user/*.read"
      ]
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 127",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Observation",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 128",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 129",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.write",
        "patient/Condition.*",
        "user/*.read",
        "system/Observation.read",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "user/*.read"
      ]
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 130",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.*",
        "system/Observation.*"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 131",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/*.read",
        "system/Patient.write",
        "system/Observation.read",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 132",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Patient.*",
        "user/Observation.*",
        "user/*.read",
        "system/Observation.read",
        "system/Condition.read",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 133",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Observation.write",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.*",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 134",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.read",
        "user/Observation.*",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "operation": "search-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 135",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.*",
        "user/Patient.*",
        "user/Observation.write",
        "user/Condition.read",
        "system/Observation.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Condition",
  "Patient",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 136",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Patient.*",
        "system/Patient.write",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Patient",
  "Observation",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 137",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 138",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Condition.read",
        "system/Patient.write",
        "system/Observation.read",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 139",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "user/Patient.read",
        "user/Observation.*",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.*",
        "system/Observation.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 140",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Observation.write",
        "user/Condition.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 141",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Condition.write",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.read",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 142",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.*",
        "system/*.read"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "patientLaunchContext": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "patient/*.read",
        "user/*.read"
      ]
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 143",
  "request": {
    "userIdentity": {
      "scopes": [
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "system/Patient.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Patient",
  "Observation",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 144",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/*.read",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 145",
  "request": {
    "userIdentity": {
      "scopes": [
        "user/Patient.read",
        "user/Observation.write",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.write",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Patient",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 146",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 147",
  "request": {
    "userIdentity": {
      "scopes": [
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/*.read",
        "system/Observation.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 148",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 149",
  "request": {
    "userIdentity": {
      "scopes": [
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "operation": "history-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 150",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Observation.*",
        "system/Condition.read"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Practitioner",
        "id": "id"
      },
      "usableScopes": [
        "user/*.read"
      ]
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 151",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "patientLaunchContext": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "patient/*.read"
      ]
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 152",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/*.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Condition.read",
        "user/*.read",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.*"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "user/*.read"
      ]
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 153",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Patient.read",
        "user/Observation.*",
        "user/Condition.*",
        "system/Patient.write",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Observation",
  "Condition",
  "Patient",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 154",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.*",
        "user/Patient.read",
        "user/Observation.write",
        "user/Observation.*",
        "system/Patient.write",
        "system/Observation.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Patient",
  "Observation",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 155",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.*",
        "system/Observation.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 156",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "operation": "search-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 157",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Condition.*",
        "user/Observation.*",
        "user/*.read",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "search-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "search-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 158",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Condition.read",
        "user/*.read",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 159",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Condition.*",
        "user/Observation.*",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Observation",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 160",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Condition.read",
        "user/Condition.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 161",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.*",
        "user/Observation.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 162",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.read",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 163",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Condition.write",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Observation",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 164",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.*",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 165",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "user/Observation.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 166",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "user/Patient.read",
        "user/Observation.write",
        "user/Condition.read",
        "user/*.read",
        "system/Observation.*",
        "system/Condition.*"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Practitioner",
        "id": "id"
      },
      "usableScopes": [
        "user/*.read"
      ]
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 167",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Condition.*",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Condition.read",
        "system/*.read"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Practitioner",
        "id": "id"
      },
      "usableScopes": [
        "user/*.read"
      ]
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 168",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "system/Observation.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 169",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/*.read",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 170",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.*",
        "system/Observation.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 171",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "user/Patient.read",
        "user/Observation.write",
        "user/Condition.read",
        "user/*.read",
        "system/Observation.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "fhirUserObject": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "user/*.read"
      ]
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 172",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Observation.write",
        "user/Observation.*",
        "user/Condition.*",
        "system/Observation.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Patient",
  "Condition",
  "Observation",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 173",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Condition.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.*"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 174",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Patient.write",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 175",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.*",
        "user/Observation.write",
        "system/Patient.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "history-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 176",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.*",
        "user/*.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 177",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Condition.*",
        "user/Patient.read",
        "user/Observation.*",
        "user/Condition.read",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Patient",
  "Condition",
  "Observation",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 178",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "patient/*.read",
        "user/Observation.*",
        "user/*.read",
        "system/Patient.write",
        "system/Patient.*",
        "system/Observation.read",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 179",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/*.read",
        "user/Patient.*",
        "system/Patient.write",
        "system/Observation.*",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "fhirUser": "practitionerFhirUser",
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 180",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Condition.write",
        "user/Patient.*",
        "user/Observation.*",
        "user/Condition.*",
        "system/Patient.write",
        "system/Patient.*",
        "system/Condition.read"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "N/A",
    "patient/*.read": "N/A",
    "user/Patient.read": "N/A",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "N/A",
    "system/Observation.*": "N/A",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Patient",
  "Observation",
  "Condition",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 181",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Condition.write",
        "patient/Condition.*",
        "patient/*.read",
        "user/Observation.*",
        "user/Condition.read",
        "user/*.read",
        "system/Observation.*",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "history-type"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "history-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "N/A",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 182",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.*",
        "user/*.read",
        "system/Patient.write",
        "system/Observation.read",
        "system/Observation.*",
        "system/*.read"
      ],
      "patientLaunchContext": {
        "hostname": "https://fhir.server.com/dev",
        "resourceType": "Patient",
        "id": "id"
      },
      "usableScopes": [
        "patient/*.read"
      ]
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "operation": "history-system",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "user/*.read",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 183",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Observation.*",
        "patient/Condition.*",
        "user/Patient.read",
        "user/Observation.write",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.write",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "history-system"
  },
  "rawCsvRow": {
    "operation": "history-system",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Observation",
  "Condition",
  "Patient",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 184",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Condition.*",
        "patient/*.read",
        "user/Patient.read",
        "user/Patient.*",
        "user/Observation.write",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.write",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "patientFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "patient/Patient.8",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "patient/*.read",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "user/Patient.*",
    "user/Observation.write": "user/Observation.write",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "system/Patient.write",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 185",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.*",
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Patient.read",
        "user/Observation.*",
        "user/Condition.read",
        "user/Condition.*",
        "user/*.read",
        "system/Observation.read"
      ],
      "usableScopes": []
    },
    "operation": "search-type"
  },
  "rawCsvRow": {
    "fhirUser": "patientFhirUser",
    "operation": "search-type",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "N/A",
    "patient/Observation.*": "patient/Observation.*",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "user/*.read",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "N/A",
    "system/Condition.read": "N/A",
    "system/Condition.*": "N/A",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 186",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Patient.read",
        "patient/Observation.read",
        "patient/Condition.write",
        "patient/Condition.*",
        "user/Patient.read",
        "user/Condition.read",
        "user/Condition.*",
        "system/Patient.*",
        "system/Observation.read",
        "system/Observation.*",
        "system/Condition.read",
        "system/Condition.*",
        "system/*.read"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "read",
    "patient/Patient.read": "patient/Patient.read",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "patient/Condition.write",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "N/A",
    "user/Condition.read": "user/Condition.read",
    "user/Condition.*": "user/Condition.*",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "system/Patient.*",
    "system/Observation.read": "system/Observation.read",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "system/Condition.read",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "system/*.read"
  }
} 1`] = `
Array [
  "Account",
  "ActivityDefinition",
  "AdverseEvent",
  "AllergyIntolerance",
  "Appointment",
  "AppointmentResponse",
  "AuditEvent",
  "Basic",
  "Binary",
  "BiologicallyDerivedProduct",
  "BodyStructure",
  "Bundle",
  "CapabilityStatement",
  "CarePlan",
  "CareTeam",
  "CatalogEntry",
  "ChargeItem",
  "ChargeItemDefinition",
  "Claim",
  "ClaimResponse",
  "ClinicalImpression",
  "CodeSystem",
  "Communication",
  "CommunicationRequest",
  "CompartmentDefinition",
  "Composition",
  "ConceptMap",
  "Condition",
  "Consent",
  "Contract",
  "Coverage",
  "CoverageEligibilityRequest",
  "CoverageEligibilityResponse",
  "DetectedIssue",
  "Device",
  "DeviceDefinition",
  "DeviceMetric",
  "DeviceRequest",
  "DeviceUseStatement",
  "DiagnosticReport",
  "DocumentManifest",
  "DocumentReference",
  "EffectEvidenceSynthesis",
  "Encounter",
  "Endpoint",
  "EnrollmentRequest",
  "EnrollmentResponse",
  "EpisodeOfCare",
  "EventDefinition",
  "Evidence",
  "EvidenceVariable",
  "ExampleScenario",
  "ExplanationOfBenefit",
  "FamilyMemberHistory",
  "Flag",
  "Goal",
  "GraphDefinition",
  "Group",
  "GuidanceResponse",
  "HealthcareService",
  "ImagingStudy",
  "Immunization",
  "ImmunizationEvaluation",
  "ImmunizationRecommendation",
  "ImplementationGuide",
  "InsurancePlan",
  "Invoice",
  "Library",
  "Linkage",
  "List",
  "Location",
  "Measure",
  "MeasureReport",
  "Media",
  "Medication",
  "MedicationAdministration",
  "MedicationDispense",
  "MedicationKnowledge",
  "MedicationRequest",
  "MedicationStatement",
  "MedicinalProduct",
  "MedicinalProductAuthorization",
  "MedicinalProductContraindication",
  "MedicinalProductIndication",
  "MedicinalProductIngredient",
  "MedicinalProductInteraction",
  "MedicinalProductManufactured",
  "MedicinalProductPackaged",
  "MedicinalProductPharmaceutical",
  "MedicinalProductUndesirableEffect",
  "MessageDefinition",
  "MessageHeader",
  "MolecularSequence",
  "NamingSystem",
  "NutritionOrder",
  "Observation",
  "ObservationDefinition",
  "OperationDefinition",
  "OperationOutcome",
  "Organization",
  "OrganizationAffiliation",
  "Parameters",
  "Patient",
  "PaymentNotice",
  "PaymentReconciliation",
  "Person",
  "PlanDefinition",
  "Practitioner",
  "PractitionerRole",
  "Procedure",
  "Provenance",
  "Questionnaire",
  "QuestionnaireResponse",
  "RelatedPerson",
  "RequestGroup",
  "ResearchDefinition",
  "ResearchElementDefinition",
  "ResearchStudy",
  "ResearchSubject",
  "RiskAssessment",
  "RiskEvidenceSynthesis",
  "Schedule",
  "SearchParameter",
  "ServiceRequest",
  "Slot",
  "Specimen",
  "SpecimenDefinition",
  "StructureDefinition",
  "StructureMap",
  "Subscription",
  "Substance",
  "SubstanceNucleicAcid",
  "SubstancePolymer",
  "SubstanceProtein",
  "SubstanceReferenceInformation",
  "SubstanceSourceMaterial",
  "SubstanceSpecification",
  "SupplyDelivery",
  "SupplyRequest",
  "Task",
  "TerminologyCapabilities",
  "TestReport",
  "TestScript",
  "ValueSet",
  "VerificationResult",
  "VisionPrescription",
]
`;

exports[`getAllowedResourceTypesForOperation-combo CASE: {
  "testName": "Combo Test Row 187",
  "request": {
    "userIdentity": {
      "scopes": [
        "patient/Observation.read",
        "patient/Condition.*",
        "user/Patient.read",
        "user/Observation.*",
        "system/Observation.*",
        "system/Condition.*"
      ],
      "usableScopes": []
    },
    "operation": "read"
  },
  "rawCsvRow": {
    "patientContext": "patientIdentity",
    "fhirUser": "practitionerFhirUser",
    "operation": "read",
    "patient/Patient.read": "N/A",
    "patient/Patient.*": "N/A",
    "patient/Observation.read": "patient/Observation.read",
    "patient/Observation.*": "N/A",
    "patient/Condition.write": "N/A",
    "patient/Condition.*": "patient/Condition.*",
    "patient/*.read": "N/A",
    "user/Patient.read": "user/Patient.read",
    "user/Patient.*": "N/A",
    "user/Observation.write": "N/A",
    "user/Observation.*": "user/Observation.*",
    "user/Condition.read": "N/A",
    "user/Condition.*": "N/A",
    "user/*.read": "N/A",
    "system/Patient.write": "N/A",
    "system/Patient.*": "N/A",
    "system/Observation.read": "N/A",
    "system/Observation.*": "system/Observation.*",
    "system/Condition.read": "N/A",
    "system/Condition.*": "system/Condition.*",
    "system/*.read": "N/A"
  }
} 1`] = `
Array [
  "Observation",
  "Condition",
  "Patient",
]
`;
