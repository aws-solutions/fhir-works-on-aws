{"version":3,"file":"GenerateRollbackRequestsFactory.js","sourceRoot":"","sources":["GenerateRollbackRequestsFactory.ts"],"names":[],"mappings":";AAAA;;;GAGG;;;;;AAEH,iDAA6B;AAE7B,oGAA4E;AAE5E,MAAqB,+BAA+B;IAChD,MAAM,CAAC,wBAAwB,CAAC,SAAwB,EAAE,GAAW;QACjE,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,IAAI,SAAS,KAAK,MAAM,EAAE;YACtB,QAAQ,GAAG;gBACP,MAAM,EAAE,IAAI;gBACZ,YAAY,EAAE,SAAS;gBACvB,SAAS,EAAE,YAAY;gBACvB,IAAI,EAAE;oBACF,WAAW,EAAE,0BAA0B;oBACvC,SAAS,EAAE,GAAG;iBACjB;gBACD,oBAAoB,EAAE;oBAClB,SAAS,EAAE,qCAAqC;oBAChD,OAAO,EAAE,oBAAoB;iBAChC;gBACD,IAAI,EAAE;oBACF,GAAG,EAAE,yDAAyD;oBAC9D,MAAM,EAAE,WAAW;iBACtB;gBACD,EAAE,EAAE,sCAAsC;gBAC1C,GAAG;gBACH,IAAI,EAAE;oBACF;wBACI,MAAM,EAAE,SAAS;wBACjB,KAAK,EAAE,CAAC,MAAM,CAAC;qBAClB;iBACJ;gBACD,MAAM,EAAE,QAAQ;aACnB,CAAC;SACL;QACD,MAAM,EAAE,GAAG,IAAA,YAAM,GAAE,CAAC;QACpB,MAAM,YAAY,GAAG,SAAS,CAAC;QAC/B,MAAM,mBAAmB,GAA2B;YAChD,EAAE;YACF,GAAG;YACH,SAAS;YACT,YAAY,EAAE,0BAA0B;YACxC,YAAY;YACZ,QAAQ;SACX,CAAC;QAEF,OAAO,mBAAmB,CAAC;IAC/B,CAAC;IAED,MAAM,CAAC,8BAA8B,CAAC,mBAA2C;QAC7E,MAAM,EAAE,EAAE,EAAE,GAAG,EAAE,YAAY,EAAE,SAAS,EAAE,GAAG,mBAAmB,CAAC;QACjE,IAAI,cAAc,GAAQ,EAAE,CAAC;QAC7B,IAAI,SAAS,KAAK,QAAQ,IAAI,SAAS,KAAK,QAAQ,EAAE;YAClD,cAAc,GAAG;gBACb,mBAAmB,EAAE,CAAC,8BAAoB,CAAC,gBAAgB,CAAC,EAAE,EAAE,QAAQ,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,CAAC;gBACnF,qBAAqB,EAAE;oBACnB;wBACI,EAAE;wBACF,GAAG;wBACH,YAAY;qBACf;iBACJ;aACJ,CAAC;SACL;aAAM,IAAI,SAAS,KAAK,MAAM,IAAI,SAAS,KAAK,QAAQ,EAAE;YACvD,cAAc,GAAG,EAAE,mBAAmB,EAAE,EAAE,EAAE,qBAAqB,EAAE,EAAE,EAAE,CAAC;SAC3E;QACD,OAAO,cAAc,CAAC;IAC1B,CAAC;CACJ;AAhED,kDAgEC","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *  SPDX-License-Identifier: Apache-2.0\n */\n\nimport uuidv4 from 'uuid/v4';\nimport { BatchReadWriteResponse, TypeOperation } from 'fhir-works-on-aws-interface';\nimport DynamoDbParamBuilder from '../src/dataServices/dynamoDbParamBuilder';\n\nexport default class GenerateRollbackRequestsFactory {\n    static buildBundleEntryResponse(operation: TypeOperation, vid: string): BatchReadWriteResponse {\n        let resource = {};\n        if (operation === 'read') {\n            resource = {\n                active: true,\n                resourceType: 'Patient',\n                birthDate: '1995-09-24',\n                meta: {\n                    lastUpdated: '2020-04-10T20:41:39.912Z',\n                    versionId: '1',\n                },\n                managingOrganization: {\n                    reference: 'Organization/2.16.840.1.113883.19.5',\n                    display: 'Good Health Clinic',\n                },\n                text: {\n                    div: '<div xmlns=\"http://www.w3.org/1999/xhtml\"><p></p></div>',\n                    status: 'generated',\n                },\n                id: '47135b80-b721-430b-9d4b-1557edc64947',\n                vid,\n                name: [\n                    {\n                        family: 'Langard',\n                        given: ['Abby'],\n                    },\n                ],\n                gender: 'female',\n            };\n        }\n        const id = uuidv4();\n        const resourceType = 'Patient';\n        const bundleEntryResponse: BatchReadWriteResponse = {\n            id,\n            vid,\n            operation,\n            lastModified: '2020-04-23T15:19:35.843Z',\n            resourceType,\n            resource,\n        };\n\n        return bundleEntryResponse;\n    }\n\n    static buildExpectedBundleEntryResult(bundleEntryResponse: BatchReadWriteResponse) {\n        const { id, vid, resourceType, operation } = bundleEntryResponse;\n        let expectedResult: any = {};\n        if (operation === 'create' || operation === 'update') {\n            expectedResult = {\n                transactionRequests: [DynamoDbParamBuilder.buildDeleteParam(id, parseInt(vid, 10))],\n                itemsToRemoveFromLock: [\n                    {\n                        id,\n                        vid,\n                        resourceType,\n                    },\n                ],\n            };\n        } else if (operation === 'read' || operation === 'delete') {\n            expectedResult = { transactionRequests: [], itemsToRemoveFromLock: [] };\n        }\n        return expectedResult;\n    }\n}\n"]}