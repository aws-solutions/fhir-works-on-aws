# Moving Amazon CloudWatch Logs to Amazon Simple Storage Service (S3)
Moving your Amazon CloudWatch logs to Amazon Simple Storage Service (S3) could improve storage costs. Follow these directions to transfer and delete your CloudWatch logs.

## Prerequisites
- S3 bucket in the same region as your log group  
- IAM role with S3 bucket write permissions

## Process

### Step 1: Setting up the S3 bucket
1. Sign in to the [Amazon S3 console](https://console.aws.amazon.com/s3/).  
1. If necessary, change the Region to match the Region where your CloudWatch logs are stored. 
1. Choose **Create bucket**.
1. Enter a name for **Bucket Name**. 
1. Select the Region where your CloudWatch logs are stored.
1. Choose **Create**.

![Create Amazon S3 bucket](/imgs/createbucket.jpg)

### Step 2: Setting up permissions in the S3 bucket
1. Choose the newly created S3 bucket to view its permissions. 
1. On the permissions tab, find the **Bucket Policy Editor**.
1. In the **Bucket Policy Editor**, add the following policy.  
    1. Change `my-exported-logs` to the name of your S3 bucket.
    1. Specify the Region endpoint for Principal.

    ```
        {
        "Version": "2012-10-17",
        "Statement": [
        {
            "Action": "s3:GetBucketAcl",
            "Effect": "Allow",
            "Resource": "arn:aws:s3:::my-exported-logs",
            "Principal": { "Service": "logs.Region.amazonaws.com" },
            "Condition": {
                "StringEquals": {
                    "aws:SourceAccount": [
                        "AccountId"
                    ]
                },
                "ArnLike": {
                        "aws:SourceArn": [
                            "arn:aws:logs:Region:AccountId:<YOUR_LOG_GROUP_NAME>:"
                        ]
                }
            }
        },
        {
            "Action": "s3:PutObject" ,
            "Effect": "Allow",
            "Resource": "arn:aws:s3:::my-exported-logs/",
            "Principal": { "Service": "logs.Region.amazonaws.com" },
            "Condition": {
                "StringEquals": {
                    "s3:x-amz-acl": "bucket-owner-full-control",
                    "aws:SourceAccount": [
                        "AccountId1"
                    ]
                },
                "ArnLike": {
                        "aws:SourceArn": [
                            "arn:aws:logs:Region:AccountId:<YOUR_LOG_GROUP_NAME>:"
                        ]
                }
            }
        }
        ]
    }
    ```
1. Save your changes.

### Step 3: Exporting CloudWatch logs to the S3 bucket
1. Open the AWS Management Console and go to the CloudWatch service. 
1. From the navigation, choose **Log groups**.
    ![Choose Log groups](/imgs/chooseloggroups.jpg)
1. Select the log group where the logs you want to export are stored. If you want to export multiple log groups, you can repeat these steps.
1. Select the CloudWatch log generated by your application.
1. Select the **Actions** menu and choose **Export data to S3**.
   ![Select Log group](/imgs/selectloggroup.jpg)
1. Choose a date range for the exported logs and note the time range used. 
    <!--- There was a comment in the quip about adding a note about time granularity in seconds, but I didn't see where it was addressed in the text. Also something about conversion to epoch time? --->
1. Choose the S3 bucket to which you want to export the logs. You should see a **Successfully created export task** notification.
    ![Successfully created export task](/imgs/successfullycreatedexporttask.jpg)
1. *(Optional)* Monitor the progress in the **Export tasks** tab.
    ![Monitor export tasks](/imgs/monitorexporttasks.jpg)
1. Once the export task completes, verify the exported logs in the specified S3 bucket. Repeat the process for each additional log group.
    <!--- What happens if the export fails? --->
    ![Verify exported logs in S3 bucket](/imgs/verifyexportins3bucket.jpg)

### Step 4: Deleting CloudWatch logs after export

