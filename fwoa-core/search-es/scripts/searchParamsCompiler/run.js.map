{"version":3,"file":"run.js","sourceRoot":"","sources":["run.ts"],"names":[],"mappings":";AAAA;;;GAGG;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEH;;;;;;;;;;;;;;;GAeG;AAEH,uCAAyB;AACzB,yEAA4E;AAC5E,4EAAyD;AAEzD,MAAM,MAAM,GAAG,IAAA,uBAAkB,GAAE,CAAC;AAEpC,MAAM,oBAAoB,GAAG,CAAC,IAAY,EAAE,EAAE;IAC1C,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC,IAAI,EAAE,EAAE,QAAQ,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC;IACrE,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAM,EAAE,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC;AAClD,CAAC,CAAC;AAEF,MAAM,GAAG,GAAG,KAAK,IAAI,EAAE;IACnB,MAAM,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IACnC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;QACV,MAAM,CAAC,KAAK,CAAC,sCAAsC,CAAC,CAAC;QACrD,MAAM,CAAC,KAAK,CAAC,qCAAqC,CAAC,CAAC;KACvD;IACD,MAAM,WAAW,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;IAC5B,MAAM,YAAY,GAAG,oBAAoB,CAAC,wBAAwB,CAAC,CAAC;IACpE,MAAM,oBAAoB,GAAG,MAAM,iDAA0B,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;IAEpF,EAAE,CAAC,aAAa,CACZ,6CAA6C,WAAW,OAAO,EAC/D,IAAI,CAAC,SAAS,CAAC,oBAAoB,CAAC,CACvC,CAAC;AACN,CAAC,CAAC;AAEF,GAAG,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *  SPDX-License-Identifier: Apache-2.0\n */\n\n/*\nThis scripts generates the JSON files at src/schema. Before running the script download the JSON FHIR definition package and copy\nthe search-parameters.json file into this directory.\n\nYou can download the latest FHIR definition from https://www.hl7.org/fhir/downloads.html or find older FHIR versions at http://hl7.org/fhir/directory.html\n\nIt is recommended to install ts-node to execute .ts files in the command line\n> npm install -g ts-node\n\nIf you are modifying the grammar at reducedFHIRPath.ne you need to compile it. The nearley compiler needs to be installed separately:\n> npm install -g nearley\n> nearleyc reducedFHIRPath.ne -o reducedFHIRPath.ts\n\nRun the script:\n> ts-node run.ts <fhirVersion>\n */\n\nimport * as fs from 'fs';\nimport { SearchImplementationGuides } from '../../src/implementationGuides';\nimport getComponentLogger from '../../src/loggerBuilder';\n\nconst logger = getComponentLogger();\n\nconst readSearchParamsFile = (path: string) => {\n    const data = JSON.parse(fs.readFileSync(path, { encoding: 'utf8' }));\n    return data.entry.map((x: any) => x.resource);\n};\n\nconst run = async () => {\n    const args = process.argv.slice(2);\n    if (!args[0]) {\n        logger.error('Error. Missing fhirVersion parameter');\n        logger.error('Usage: ts-node run.ts <fhirVersion>');\n    }\n    const fhirVersion = args[0];\n    const searchParams = readSearchParamsFile('search-parameters.json');\n    const compiledSearchParams = await SearchImplementationGuides.compile(searchParams);\n\n    fs.writeFileSync(\n        `../../src/schema/compiledSearchParameters.${fhirVersion}.json`,\n        JSON.stringify(compiledSearchParams),\n    );\n};\n\nrun().then(logger.info).catch(logger.error);\n"]}